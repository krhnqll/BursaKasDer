function togglePassword() {
    var passwordField = document.getElementById("adm_Password");
    if (passwordField.type === "password") {
        passwordField.type = "text";
    } else {
        passwordField.type = "password";
    }
}

$(document).ready(function () {
    $(".edit-user-btn").click(function () {
        var userId = $(this).data("id");

        // Modal içeriğini yükleme mesajı ile doldur
        $("#editUserModalContent").html('<div class="text-center p-3"><i class="fa fa-spinner fa-spin"></i> Yükleniyor...</div>');

        // Modalı aç
        $("#editUserModal").modal("show");

        // AJAX ile formu yükle
        $.ajax({
            url: "/Admin/admin_Edit_Profile/" + userId,
            type: "GET",
            success: function (data) {
                $("#editUserModalContent").html(data);
            },
            error: function () {
                alert("Kullanıcı bilgileri yüklenirken hata oluştu!");
            }
        });
    });

    // **2. AJAX ile Güncelleme İşlemi**
    $(document).on("submit", "#editUserForm", function (e) {
        e.preventDefault();  // Sayfanın yeniden yüklenmesini engelle

        var formData = $(this).serialize(); // Form verilerini al

        $.ajax({
            url: "/Admin/admin_Edit_Profile", // Güncelleme işlemi için URL
            type: "POST",
            data: formData,
            success: function (response) {
                if (response.success) {
                    Swal.fire({
                        title: "Başarılı!",
                        text: "Kullanıcı bilgileri güncellendi.",
                        icon: "success",
                        confirmButtonText: "Tamam"
                    }).then(() => {
                         // JSON içindeki URL'ye yönlendir
                        $("#editUserModal").modal("hide"); // Modalı kapat
                        $("body").removeClass("modal-open"); // Bootstrap modal arka planını temizle
                        $(".modal-backdrop").remove(); 
                    });
                } else {
                    Swal.fire({
                        title: "Hata!",
                        text: response.message || "Bir hata oluştu.",
                        icon: "error",
                        confirmButtonText: "Tamam"
                    });
                }
            },

            error: function () {
                Swal.fire({
                    title: "Hata!",
                    text: "Güncelleme işlemi başarısız oldu.",
                    icon: "error",
                    confirmButtonText: "Tamam"
                });
            }
        });
    });
});

function submitAddUserForm() {
    var form = $("#addUserForm");
    var formData = form.serialize(); // Form verilerini al

    $.ajax({
        url: "/Admin/admin_add_NewUser",
        type: "POST",
        data: formData,
        success: function (response) {
            if (response.success) {
                Swal.fire({
                    title: "Başarılı!",
                    text: "Yeni kullanıcı başarıyla eklendi!",
                    icon: "success",
                    confirmButtonText: "Tamam"
                }).then(() => {
                    $("#addUserModal").modal("hide"); // Modalı kapat
                    form[0].reset(); // Formu sıfırla
                    $(".modal-backdrop").remove(); // Modal arkaplanını kaldır
                    $("body").removeClass("modal-open"); // Açık modal sınıfını temizle
                    location.reload(); // Sayfayı yenile (veya listeyi güncelle)
                });
            } else {
                Swal.fire({
                    title: "Hata!",
                    text: response.message || "Bir hata oluştu!",
                    icon: "error",
                    confirmButtonText: "Tamam"
                });
            }
        },
        error: function () {
            Swal.fire({
                title: "Hata!",
                text: "İşlem sırasında bir hata oluştu.",
                icon: "error",
                confirmButtonText: "Tamam"
            });
        }
    });
}


   